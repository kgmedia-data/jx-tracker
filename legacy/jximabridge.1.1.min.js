var videoContent=document.getElementById("contentElement"),mainContainer=document.getElementById("mainContainer"),adContainer=document.getElementById("adContainer"),content=document.getElementById("content"),imageContainer=document.getElementById("startEndImg"),params=getUrlParams(),srcUrl="https://ad.jixie.io/v1/video",paramsUrl=["source=outstream"];params.domain&&paramsUrl.push("domain="+params.domain),params.pageurl&&paramsUrl.push("pageurl="+params.pageurl),params.country&&paramsUrl.push("country="+params.country),params.device&&paramsUrl.push("device="+params.device),params.creativeid&&paramsUrl.push("creativeid="+params.creativeid),0<paramsUrl.length&&(srcUrl+="?"+paramsUrl.join("&")),params.defaultImage&&(imageContainer.innerHTML='<img src="'+params.defaultImage+'" width="640px" height="360"/>',imageContainer.style.display="block");var toload=!1,hasad=!1,isPaused=!1,adVideoContainer=new google.ima.AdDisplayContainer(adContainer,videoContent),adsLoader=new google.ima.AdsLoader(adVideoContainer);adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,onAdsManagerLoaded,!1),adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError,!1);var contentEndedListener=function(){adsLoader.contentComplete()},adsRequest=new google.ima.AdsRequest;function requestAds(){"undefined"!=typeof adsManager&&(toload=!1,adVideoContainer.initialize(),adsManager.start())}function onAdsManagerLoaded(e){(new google.ima.AdsRenderingSettings).enablePreloading=!0,adsManager=e.getAdsManager(videoContent),adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError),adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,onContentPauseRequested),adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,onContentResumeRequested),adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,onAdEvent),adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,onAdEvent);try{adsManager.init(640,360,google.ima.ViewMode.NORMAL),parent.postMessage("jxhasad","*"),hasad=!0,toload&&requestAds()}catch(e){}}function onContentPauseRequested(){}function onContentResumeRequested(){}function onAdEvent(e){var a=e.getAd();switch(e.type){case google.ima.AdEvent.Type.STARTED:if(imageContainer.style.display="none",a.isLinear()&&!params.defaultImage)var n=setInterval(function(){var e=adsManager.getRemainingTime();(0==parseInt(e)||parseFloat(e)<.6)&&(adsManager.pause(),clearInterval(n))},300);break;case google.ima.AdEvent.Type.COMPLETE:params.defaultImage&&(imageContainer.style.display="block"),contentEndedListener()}}function onAdError(e){parent.postMessage("jxnoad","*"),params.defaultImage&&(imageContainer.style.display="block")}function getUrlParams(){var t={},e=window.location.href.match(/(\?|\&)([^=]+)\=([^&]+)/gi);return e&&0<e.length&&e.forEach(function(e,a){var n=e.replace(/[&\\?]/,"").split("=");t[n[0]]=n[1]}),t}adsRequest.adTagUrl=srcUrl,adsRequest.linearAdSlotWidth=640,adsRequest.linearAdSlotHeight=400,videoContent.volume=0,videoContent.muted=!0,adsRequest.setAdWillAutoPlay(!0),adsRequest.setAdWillPlayMuted(!0),hasad||adsLoader.requestAds(adsRequest),window.onmessage=function(e){"jxvisible"==e.data?(toload=!0,isPaused?(adsManager.resume(),isPaused=!1):requestAds()):"jxnotvisible"==e.data&&"undefined"!=typeof adsManager&&(adsManager.pause(),isPaused=!0)};